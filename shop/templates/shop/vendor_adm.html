{% extends 'shop/base.html' %}
{% load humanize %}

{% load static %}

{% block content %}

<div class="box">
  <h1 class="title">Vendor Admin - {{ vendor.name }} <a href="{% url 'edit_vendor' %}" class="custom-button">Edit &#8594;</a></h1>
    <strong>Balance: </strong> Ksh. {{ vendor.get_balance|intcomma }}<br>
    <strong>Paid: </strong> Ksh. {{ vendor.get_paid_amount|intcomma }}
<hr>

  <br>
  <a href="{% url 'add_post' %}" class="button is-dark is-uppercase mb-6"><strong>Add Product</strong></a>
</div>
<br>
<div class="box-primary">


<h2 class="is-size-3 mb-4">My Products</h2>
  {% if products %}
  <table class="table is-fullwidth">
    <thead>
      <th></th>
      <th>Product</th>
      <th>Price</th>
      <th>Status</th>
      <th></th>
      <th></th>
    </thead>
    <tbody>
      {% for item in products %}
      <tr>
        <td>
          <div class="image-container">
            <img src="{{ item.get_thumbnail }}" class="product-image">
          </div>
        </td>
        <td>{{ item.title }}</td>
        <td>Ksh. {{ item.price|intcomma }}</td>
        <td>In store</td>
        <td>
    <button class="btn btn-delete btn-danger" data-product-id="{{ item.id }}">
            <span class="mdi mdi-delete mdi-24px"></span>
            <span class="mdi mdi-delete-empty mdi-24px"></span>
            <span>Delete</span>
          </button>
        </td>
        <td>
          <button class="btn btn-edit btn-success" data-product-id="{{ item.id }}">
            <span class="mdi mdi-edit mdi-24px"></span>
            <span class="mdi mdi-edit-outline mdi-24px"></span>
            <span>Edit</span>
          </button>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p class="empty-message">You don't have any products</p>
  {% endif %}
</div>

<!--orders-->
<div class="box">
    <h2 class="title">My Orders</h2>

    {% if orders %}
       <p>You have new orders <a href="{% url 'order_tickets' %}" class="custom-button">Check &#8594;</a></p>
    {% else %}
    <p>You don't have any orders</p>
    {% endif %}
</div>


<!--endorders-->
<style>

  .box {
    background-color: #f2f2f2;
    border: 1px solid #ccc;
    padding: 20px;
    text-align: center;
    border-radius: 5px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .title {
    color: #333;
    font-size: 24px;
    margin-bottom: 20px;
  }

  .button {
    display: inline-block;
    padding: 10px 20px;
    background-color: #333;
    color: #fff;
    text-decoration: none;
    border-radius: 4px;
    transition: background-color 0.3s ease;
  }

  .button:hover {
    background-color: #555;
  }

  .mb-6 {
    margin-bottom: 30px;
  }

  .is-uppercase {
    text-transform: uppercase;
  }

.table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
}

.table th,
.table td {
  padding: 10px;
  text-align: left;
}

.table th {
  font-weight: bold;
  border-bottom: 1px solid #ddd;
  color: #333;
}

.table td {
  border-bottom: 1px solid #eee;
}

.button {
  display: inline-block;
  padding: 10px 20px;
  background-color: #333;
  color: #fff;
  text-decoration: none;
  border-radius: 5px;
  transition: background-color 0.3s;
}

.button:hover {
  background-color: #222;
}

<!--.btn-delete,-->
<!--.btn-edit {-->
<!--  display: inline-block;-->
<!--  padding: 5px;-->
<!--  background-color: #eee;-->
<!--  border: none;-->
<!--  border-radius: 5px;-->
<!--  cursor: pointer;-->
<!--  transition: background-color 0.3s;-->
<!--}-->

<!--.btn-delete:hover,-->
<!--.btn-edit:hover {-->
<!--  background-color: #ddd;-->
<!--}-->

/* Delete button */
.btn-delete {
  display: inline-block;
  padding: 5px;
  background-color: #ff6b6b; /* Red background color */
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s;
}

.btn-delete:hover {
  background-color: #ff4444; /* Darker red on hover */
}

/* Edit button */
.btn-edit {
  display: inline-block;
  padding: 5px;
  background-color: #6bc76b; /* Green background color */
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s;
}

.btn-edit:hover {
  background-color: #5ca45c; /* Darker green on hover */
}


.image-container {
  width: 100px;
  height: 100px;
  overflow: hidden;
  border-radius: 5px;
}

.product-image {
  object-fit: cover;
  width: 100%;
  height: 100%;
}

.empty-message {
  font-size: 18px;
  color: #888;
  text-align: center;
  margin-top: 20px;
}



.box {
    margin: 20px;
    padding: 20px;
    background-color: #f5f5f5;
    border-radius: 5px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.title {
    font-size: 24px;
    margin-bottom: 20px;
}

.order-card {
    margin-bottom: 10px;
    padding: 20px;
    border-radius: 5px;
}

.success {
    background-color: #d4edda;
}

.info {
    background-color: #d1ecf1;
}

.subtitle {
    font-size: 20px;
    margin-bottom: 10px;
}

.table {
    width: 100%;
    margin-top: 20px;
    border-collapse: collapse;
}

.table th,
.table td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

.table th {
    font-weight: bold;
}

.table td {
    vertical-align: middle;
}

.table td:first-child {
    font-weight: bold;
}

.p-4 {
    padding: 16px;
}

.mt-4 {
    margin-top: 16px;
}


.custom-button {
  display: inline-block;
  padding: 10px 20px;
  border-radius: 4px;
  text-decoration: none;
  font-weight: bold;
  text-align: center;
}

.custom-button.is-info {
  background-color: #209cee;
  color: #fff;
}

.custom-button.is-uppercase {
  text-transform: uppercase;
}

.custom-button:hover {
  opacity: 0.8;
}

 </style>


<!-- Add this script in your HTML template, preferably at the bottom before </body> -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
  // Function to handle the Edit button click
  function handleEditButtonClick(productId) {
    // Construct the URL for the product editing page
    const editUrl = `{% url 'edit_product' 0 %}`.replace('0', productId);

    // Redirect to the product editing page
    window.location.href = editUrl;
  }

  // Add event listeners to all Edit buttons
  const editButtons = document.querySelectorAll('.btn-edit');
  editButtons.forEach(button => {
    const productId = button.getAttribute('data-product-id');
    button.addEventListener('click', () => handleEditButtonClick(productId));
  });



  $(document).ready(function() {
    // Function to handle the Delete button click
    function handleDeleteButtonClick(productId) {
      const confirmDelete = confirm('Are you sure you want to delete this product?');
      if (confirmDelete) {
        // Send an AJAX request to delete the product
        $.ajax({
          type: 'POST',
          url: `{% url 'delete_product' 0 %}`.replace('0', productId),
          data: {
            csrfmiddlewaretoken: '{{ csrf_token }}',
          },
          success: function(response) {
            // Reload the page to reflect the updated product list
            location.reload();
          },
          error: function(xhr, errmsg, err) {
            console.error(errmsg);
          }
        });
      }
    }

    // Add event listeners to all Delete buttons
    const deleteButtons = document.querySelectorAll('.btn-delete');
    deleteButtons.forEach(button => {
      const productId = button.getAttribute('data-product-id');
      button.addEventListener('click', () => handleDeleteButtonClick(productId));
    });
  });
</script>

{% endblock %}

